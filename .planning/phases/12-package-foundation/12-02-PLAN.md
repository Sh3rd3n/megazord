---
phase: 12-package-foundation
plan: 02
type: execute
wave: 2
depends_on:
  - "12-01"
files_modified:
  - src/cli/utils/version.ts
  - src/cli/commands/install.ts
  - src/cli/commands/update.ts
  - src/cli/index.ts
autonomous: true
requirements:
  - REPO-04
  - REPO-01

must_haves:
  truths:
    - "node bin/megazord.mjs --version returns 1.0.0 (read from package.json, not hardcoded)"
    - "install.ts and update.ts import VERSION from shared util instead of hardcoding it"
    - "sh3rd3n/megazord exists as a private GitHub repo with all code pushed"
    - "No Italian strings exist in any published file directory"
  artifacts:
    - path: "src/cli/utils/version.ts"
      provides: "Shared version utility extracting findPackageJson and VERSION"
      exports: ["VERSION", "findPackageJson"]
    - path: "src/cli/commands/install.ts"
      provides: "Install command using dynamic version from shared util"
      contains: "import.*version"
    - path: "src/cli/commands/update.ts"
      provides: "Update command using dynamic version from shared util"
      contains: "import.*version"
    - path: "src/cli/index.ts"
      provides: "CLI entry point importing from shared version util"
      contains: "import.*version"
  key_links:
    - from: "src/cli/utils/version.ts"
      to: "package.json"
      via: "findPackageJson() walks up directories to find and read package.json"
      pattern: "findPackageJson"
    - from: "src/cli/commands/install.ts"
      to: "src/cli/utils/version.ts"
      via: "imports VERSION constant"
      pattern: "import.*VERSION.*from.*version"
    - from: "src/cli/commands/update.ts"
      to: "src/cli/utils/version.ts"
      via: "imports VERSION constant"
      pattern: "import.*VERSION.*from.*version"
---

<objective>
Deduplicate version handling by extracting findPackageJson to a shared utility, rebuild the CLI, audit for Italian strings, and create the GitHub repository with initial push.

Purpose: Eliminate hardcoded version strings (single source of truth in package.json), verify no Italian text leaks into published files, and establish the GitHub remote for the project.
Output: Shared version utility, updated CLI commands, rebuilt bin/, verified language purity, GitHub repo with code pushed
</objective>

<execution_context>
@/Users/sh3rd3n/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sh3rd3n/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-package-foundation/12-RESEARCH.md
@.planning/phases/12-package-foundation/12-01-SUMMARY.md
@src/cli/index.ts
@src/cli/commands/install.ts
@src/cli/commands/update.ts
@src/cli/utils/colors.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract shared version utility and update CLI commands</name>
  <files>src/cli/utils/version.ts, src/cli/commands/install.ts, src/cli/commands/update.ts, src/cli/index.ts</files>
  <action>
**Step 1: Create `src/cli/utils/version.ts`**

Extract the `findPackageJson()` function from `src/cli/index.ts` into a new shared utility module. Export both the function and a `VERSION` constant:

```typescript
import { existsSync, readFileSync } from "node:fs";
import { dirname, join } from "node:path";
import { fileURLToPath } from "node:url";

/**
 * Resolve package.json by walking up from the current file's directory.
 * Works both in dev (src/cli/utils/version.ts -> ../../../package.json) and
 * after bundling (bin/megazord.mjs -> ../package.json).
 */
export function findPackageJson(): string {
  let dir = dirname(fileURLToPath(import.meta.url));
  while (dir !== dirname(dir)) {
    const candidate = join(dir, "package.json");
    if (existsSync(candidate)) return candidate;
    dir = dirname(dir);
  }
  throw new Error("Could not find package.json");
}

const pkg = JSON.parse(readFileSync(findPackageJson(), "utf-8")) as {
  version: string;
};

export const VERSION: string = pkg.version;
```

**Step 2: Update `src/cli/index.ts`**

Remove the `findPackageJson()` function and the `pkg` constant. Import from the shared utility instead:

Replace:
```typescript
import { existsSync, readFileSync } from "node:fs";
import { dirname, join } from "node:path";
import { fileURLToPath } from "node:url";

// Resolve package.json by walking up...
function findPackageJson(): string { ... }

const pkg = JSON.parse(readFileSync(findPackageJson(), "utf-8")) as { version: string; };
```

With:
```typescript
import { VERSION } from "./utils/version.js";
```

Then update all `pkg.version` references to `VERSION`:
- `.version(pkg.version)` -> `.version(VERSION)`
- `console.log(pkg.version)` -> `console.log(VERSION)`

Remove the now-unused imports: `existsSync`, `readFileSync` from `node:fs`, `dirname`, `join` from `node:path`, `fileURLToPath` from `node:url` — BUT only if no other code in index.ts uses them (check first).

**Step 3: Update `src/cli/commands/install.ts`**

Remove the hardcoded `const VERSION = "0.1.0";` line (currently line 15).
Add import at the top: `import { VERSION } from "../utils/version.js";`

Do NOT change any other VERSION usages in the file — the variable name stays the same, only the source changes.

**Step 4: Update `src/cli/commands/update.ts`**

Remove the hardcoded `const VERSION = "0.1.0";` line (currently line 7).
Add import at the top: `import { VERSION } from "../utils/version.js";`

Do NOT change any other VERSION usages in the file.

**Step 5: Build and verify**

Run `bun run build` to regenerate `bin/` files via tsdown.
Run `node bin/megazord.mjs --version` — must output `1.0.0` (not `0.1.0`).
Run `grep -r "0.1.0" bin/` — should return NO matches (confirms no hardcoded stale version in built output).
  </action>
  <verify>
Run `bun run build` and verify it succeeds.
Run `node bin/megazord.mjs --version` and verify output is `1.0.0`.
Run `grep -rn "const VERSION = " src/cli/commands/install.ts src/cli/commands/update.ts` — should return nothing (no hardcoded VERSION).
Run `grep -rn "import.*VERSION.*from.*version" src/cli/commands/install.ts src/cli/commands/update.ts src/cli/index.ts` — should show imports in all three files.
  </verify>
  <done>
findPackageJson() and VERSION live in src/cli/utils/version.ts as single source of truth.
install.ts, update.ts, and index.ts all import VERSION from the shared utility.
No hardcoded "0.1.0" remains in source or built output.
node bin/megazord.mjs --version outputs 1.0.0.
  </done>
</task>

<task type="auto">
  <name>Task 2: Language audit and GitHub repository creation</name>
  <files><!-- intentionally empty: this task performs shell-only operations (grep audit, gh repo create, gh repo edit) with no file modifications --></files>
  <action>
**Step 1: Language audit**

Search for Italian strings in ALL published file directories. These are the directories listed in the `files` array plus any auto-included files (LICENSE, package.json):

```bash
# Search for common Italian words in published directories
grep -ri "installazione\|configurazione\|funzionalità\|aggiornamento\|impostazioni\|versione\|progetto\|gestione\|errore\|avviso\|successo\|completato\|disponibile\|nessuno\|esempio\|attenzione\|obbligatorio\|opzionale" \
  bin/ scripts/ skills/ agents/ hooks/ commands/ .claude-plugin/ \
  package.json LICENSE CHANGELOG.md
```

If any Italian strings are found, fix them (translate to English). The research found none, but this step confirms post-changes.

Also check for any non-English text in comments within source files that will be bundled:
```bash
grep -ri "installazione\|configurazione\|funzionalità" src/
```

**Step 2: Create GitHub repository**

Run the following command to create the private GitHub repo and push all code:

```bash
gh repo create sh3rd3n/megazord \
  --private \
  --source=. \
  --remote=origin \
  --push \
  --description "Claude Code framework for project management, code quality, and multi-agent coordination"
```

This command:
- Creates a private repo at github.com/sh3rd3n/megazord
- Sets the remote named `origin` to point to it
- Pushes the current branch

If the command fails because a remote named `origin` already exists, first check with `git remote -v`. If it points to the wrong URL, run `git remote set-url origin https://github.com/sh3rd3n/megazord.git` and then `git push -u origin master`.

**Step 3: Add GitHub topics**

After repo creation, add topics for discoverability:
```bash
gh repo edit sh3rd3n/megazord --add-topic claude-code,claude-code-plugin,ai-agent,project-management,code-quality,multi-agent,workflow-automation,cli,typescript,nodejs
```

**Step 4: Final verification**

Run `npm pack --dry-run 2>&1` and verify the complete list:
- MUST include entries from: `scripts/`, `bin/`, `hooks/`, `skills/`, `agents/`, `commands/`, `.claude-plugin/`, `CHANGELOG.md`, `LICENSE`, `package.json`
- MUST NOT include entries from: `.planning/`, `.git/`, `.DS_Store`, `src/`, `node_modules/`, `dist/`

Run `gh repo view sh3rd3n/megazord --json name,visibility,description` to confirm the repo exists, is private, and has the correct description.
  </action>
  <verify>
Run `node bin/megazord.mjs --version` — outputs `1.0.0`.
Run `gh repo view sh3rd3n/megazord --json name,visibility` — shows name=megazord, visibility=PRIVATE.
Run `npm pack --dry-run 2>&1 | grep "scripts/"` — returns at least one match.
Run `npm pack --dry-run 2>&1 | grep ".planning/"` — returns zero matches.
Language audit grep commands return zero matches for Italian words.
  </verify>
  <done>
No Italian strings found in any published file directory.
GitHub repo sh3rd3n/megazord exists as a private repository with all code pushed.
GitHub topics are set for discoverability.
npm pack --dry-run confirms correct inclusion/exclusion of all directories.
  </done>
</task>

</tasks>

<verification>
1. `node bin/megazord.mjs --version` outputs `1.0.0`
2. `grep -rn "const VERSION = " src/cli/commands/` returns nothing
3. `gh repo view sh3rd3n/megazord --json visibility` shows `PRIVATE`
4. `git remote get-url origin` returns `https://github.com/sh3rd3n/megazord.git` (or SSH equivalent)
5. `npm pack --dry-run 2>&1 | grep -c "scripts/"` returns >= 1
6. Italian language grep returns zero matches in published directories
</verification>

<success_criteria>
- VERSION is read from package.json at runtime via shared utility (no hardcoded strings)
- node bin/megazord.mjs --version outputs 1.0.0
- All user-facing text in published directories is in English
- sh3rd3n/megazord exists as a private GitHub repo with all code pushed
- GitHub topics set for discoverability
</success_criteria>

<output>
After completion, create `.planning/phases/12-package-foundation/12-02-SUMMARY.md`
</output>
