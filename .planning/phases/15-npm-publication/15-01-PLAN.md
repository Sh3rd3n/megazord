---
phase: 15-npm-publication
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [package.json, src/lib/paths.ts]
autonomous: true
requirements: [NPM-03, NPM-02]

must_haves:
  truths:
    - "package.json has publishConfig with access public and registry URL"
    - "Both `megazord` and `megazord-cli` bin entries exist pointing to same file"
    - "package.json version is 1.1.0"
    - "paths.ts exports a megazordDir constant pointing to ~/.claude/megazord/"
  artifacts:
    - path: "package.json"
      provides: "publishConfig, dual bin entries, version 1.1.0"
      contains: "publishConfig"
    - path: "src/lib/paths.ts"
      provides: "megazordDir path constant"
      contains: "megazordDir"
  key_links:
    - from: "package.json"
      to: "bin/megazord.mjs"
      via: "dual bin entries"
      pattern: "megazord-cli.*bin/megazord\\.mjs"
---

<objective>
Configure package.json for npm publication and add the megazordDir path constant.

Purpose: NPM-03 requires publishConfig. NPM-02 requires `bunx megazord-cli` to resolve the correct binary (requires dual bin entry). The new `~/.claude/megazord/` file placement (user decision) needs a shared path constant.
Output: package.json ready for publish, paths.ts with megazordDir export
</objective>

<execution_context>
@/Users/sh3rd3n/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sh3rd3n/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/15-npm-publication/15-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add publishConfig, dual bin entry, and bump version to 1.1.0</name>
  <files>package.json</files>
  <action>
Edit package.json to make three changes:

1. **Add publishConfig** (after the `engines` field):
```json
"publishConfig": {
  "access": "public",
  "registry": "https://registry.npmjs.org/"
}
```
This is required for NPM-03 and prevents edge-case failures with `npm publish --provenance` for new packages.

2. **Add dual bin entry** — change the `bin` field from:
```json
"bin": {
  "megazord": "bin/megazord.mjs"
}
```
to:
```json
"bin": {
  "megazord": "bin/megazord.mjs",
  "megazord-cli": "bin/megazord.mjs"
}
```
Both bunx and npx resolve binaries by matching the package name. Since the package is `megazord-cli`, `bunx megazord-cli` requires a bin entry named `megazord-cli`. The original `megazord` entry is kept for users who install globally (`npm i -g megazord-cli` then run `megazord`).

3. **Bump version** to `1.1.0` — change `"version": "1.0.0"` to `"version": "1.1.0"`. Per research recommendation, 1.1.0 represents the distribution-ready version. CHANGELOG.md already has a v1.1.0 placeholder entry.

Also update `.claude-plugin/plugin.json` version field from `"1.0.0"` to `"1.1.0"` to keep versions synchronized (pattern from Phase 12).
  </action>
  <verify>
Run: `cat package.json | grep -A3 publishConfig` — should show access: public and registry URL.
Run: `cat package.json | grep -A3 '"bin"'` — should show both megazord and megazord-cli entries.
Run: `cat package.json | grep '"version"'` — should show 1.1.0.
Run: `cat .claude-plugin/plugin.json | grep '"version"'` — should show 1.1.0.
Run: `bun run build` — build must succeed with updated package.json.
  </verify>
  <done>package.json has publishConfig with access public, dual bin entries (megazord + megazord-cli), version 1.1.0, and plugin.json version matches</done>
</task>

<task type="auto">
  <name>Task 2: Add megazordDir path constant to paths.ts</name>
  <files>src/lib/paths.ts</files>
  <action>
Add a new exported constant to `src/lib/paths.ts` for the dedicated Megazord installation directory:

```typescript
/** Megazord installation directory: ~/.claude/megazord/ */
export const megazordDir = join(claudeDir, "megazord");
```

Add it after the existing `claudeDir` constant (before `pluginsDir`). This path will be used by the refactored install/update/uninstall commands in plan 15-02.

Also add:
```typescript
/** Megazord version file: ~/.claude/megazord/.version */
export const megazordVersionPath = join(megazordDir, ".version");

/** Megazord update check file: ~/.claude/megazord/.update-check */
export const megazordUpdateCheckPath = join(megazordDir, ".update-check");
```

These paths support the version tracking and update check features required by CONTEXT decisions.

Do NOT remove any existing exports — other files still reference them. The old plugin cache paths will be phased out in plan 15-02 when install/update/uninstall are refactored.
  </action>
  <verify>
Run: `bun run typecheck` — must pass with no errors.
Run: `grep "megazordDir" src/lib/paths.ts` — should show the new export.
  </verify>
  <done>paths.ts exports megazordDir, megazordVersionPath, and megazordUpdateCheckPath constants</done>
</task>

</tasks>

<verification>
1. `bun run build` succeeds
2. `bun run typecheck` passes
3. package.json contains publishConfig, dual bin, version 1.1.0
4. plugin.json version is 1.1.0
5. paths.ts exports megazordDir, megazordVersionPath, megazordUpdateCheckPath
</verification>

<success_criteria>
- publishConfig field exists in package.json with `access: "public"` and `registry` URL
- Both `megazord` and `megazord-cli` bin entries point to `bin/megazord.mjs`
- package.json and plugin.json versions are both `1.1.0`
- `src/lib/paths.ts` exports `megazordDir`, `megazordVersionPath`, `megazordUpdateCheckPath`
- Build and typecheck pass
</success_criteria>

<output>
After completion, create `.planning/phases/15-npm-publication/15-01-SUMMARY.md`
</output>
