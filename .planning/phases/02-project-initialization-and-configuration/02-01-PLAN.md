---
phase: 02-project-initialization-and-configuration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/config.ts
  - skills/init/design-system.md
autonomous: true
requirements: [QUAL-07, CRTX-06]

must_haves:
  truths:
    - "Config schema validates a well-formed megazord.config.json and rejects malformed ones"
    - "Three preset profiles (strict, balanced, minimal) produce correct default values when applied"
    - "GSD config.json can be detected and migrated to Megazord format without data loss"
    - "Config load/save round-trips through the Zod schema without mutation"
    - "Design system tokens define a consistent Megazord visual identity with tech/mecha aesthetic"
  artifacts:
    - path: "src/lib/config.ts"
      provides: "Zod config schema, TypeScript types, presets, load/save, GSD migration"
      exports: ["configSchema", "MegazordConfig", "presets", "loadConfig", "saveConfig", "detectGsdConfig", "migrateGsdConfig", "applyPreset", "qualitySchema", "workflowSchema"]
    - path: "skills/init/design-system.md"
      provides: "Shared visual identity tokens: banners, boxes, separators, status symbols, progress display"
      contains: "MEGAZORD"
  key_links:
    - from: "src/lib/config.ts"
      to: "zod"
      via: "z.object schema definition"
      pattern: "import.*from.*zod"
    - from: "src/lib/config.ts"
      to: "fs-extra"
      via: "readJsonSync/writeJsonSync for config persistence"
      pattern: "import.*from.*fs-extra"
---

<objective>
Create the Megazord config schema (TypeScript + Zod) and design system reference file that all Phase 2 skills depend on.

Purpose: Establish the single source of truth for configuration (Zod schema with types, presets, load/save, GSD migration) and visual identity (ASCII art design tokens) that the init and settings skills will reference.

Output: `src/lib/config.ts` with full schema and utilities, `skills/init/design-system.md` with visual tokens.
</objective>

<execution_context>
@/Users/sh3rd3n/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sh3rd3n/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-project-initialization-and-configuration/02-RESEARCH.md
@src/lib/paths.ts
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Megazord config schema with Zod v4, presets, and GSD migration</name>
  <files>src/lib/config.ts</files>
  <action>
Create `src/lib/config.ts` with the following components, using Zod v4 (already installed as `zod@^4.3.0`):

**1. Quality schema** (`qualitySchema`):
- `tdd`: boolean, default `true`
- `review`: enum `["auto", "manual", "off"]`, default `"auto"`
- `brainstorming`: boolean, default `true`
- `cortex`: boolean, default `true` (CRTX-06)
- `debug`: enum `["systematic", "quick"]`, default `"systematic"`

**2. Workflow schema** (`workflowSchema`):
- `research`: boolean, default `true`
- `plan_check`: boolean, default `true`
- `verifier`: boolean, default `true`

**3. Full config schema** (`configSchema`):
- `version`: literal `1`, default `1` (enables future migration detection)
- `project_name`: string (required, no default)
- `mode`: enum `["yolo", "interactive"]`, default `"yolo"`
- `depth`: enum `["quick", "standard", "comprehensive"]`, default `"comprehensive"`
- `parallelization`: boolean, default `true`
- `commit_docs`: boolean, default `true`
- `model_profile`: enum `["quality", "balanced", "budget"]`, default `"quality"` (per user decision: quality-first, Opus everywhere)
- `quality`: qualitySchema, default `{}`
- `workflow`: workflowSchema, default `{}`

**4. Type export**: `MegazordConfig = z.infer<typeof configSchema>`

**5. Preset profiles** (as `Record<string, Partial<MegazordConfig>>`):
- `strict`: Everything on. model_profile "quality". quality: all true/auto/systematic. workflow: all true.
- `balanced`: Review + brainstorming on, TDD and CORTEX off. model_profile "balanced". quality: tdd false, review "auto", brainstorming true, cortex false, debug "quick". workflow: all true.
- `minimal`: Essential only. model_profile "budget". quality: all off/off. workflow: all false.

**6. Load/save utilities**:
- `loadConfig(planningDir: string): MegazordConfig` — reads `megazord.config.json` from planningDir, validates through `configSchema.safeParse()`, throws descriptive error if not found or invalid.
- `saveConfig(planningDir: string, config: MegazordConfig): void` — writes config to `megazord.config.json` with `{ spaces: 2 }` formatting.
- `applyPreset(presetName: keyof typeof presets, overrides?: Partial<MegazordConfig>): Partial<MegazordConfig>` — merges preset with optional overrides.

**7. GSD migration utilities**:
- `detectGsdConfig(planningDir: string): GsdConfig | null` — checks for `config.json` in planningDir, returns null if not found or if it has a `version` field (Megazord format). Define `GsdConfig` interface to cover known GSD fields: mode, depth, parallelization, commit_docs, model_profile, workflow (research, plan_check, verifier, auto_advance), git (branching_strategy).
- `migrateGsdConfig(gsd: GsdConfig, projectName: string): MegazordConfig` — maps GSD fields to Megazord schema. For GSD-specific fields with no Megazord equivalent (auto_advance, branching_strategy), ignore silently. Default quality to strict preset values. Parse through `configSchema.parse()` to get full defaults.

**8. Config filename constant**: `CONFIG_FILENAME = "megazord.config.json"` (exported for reference).

Use existing dependencies only: `zod`, `fs-extra` (with `@types/fs-extra`), `node:path`. Follow existing codebase patterns from `src/lib/paths.ts` (ESM imports, named exports). Use tabs for indentation per biome.json config.
  </action>
  <verify>
Run `bun run typecheck` — must pass with no errors.
Run `bun run lint` — must pass (or only have warnings, no errors).
Verify exports: `grep -c "export" src/lib/config.ts` should show 10+ exports.
  </verify>
  <done>
`src/lib/config.ts` exists with: configSchema (Zod v4), MegazordConfig type, 3 presets (strict/balanced/minimal), loadConfig, saveConfig, applyPreset, detectGsdConfig, migrateGsdConfig — all type-checking clean.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Megazord design system reference</name>
  <files>skills/init/design-system.md</files>
  <action>
Create `skills/init/design-system.md` as a supporting file for the init skill (and future skills). This is a markdown reference that defines Megazord's visual identity tokens. Skills `@`-reference this file for consistent visual output.

**Per user decisions:** Tech/mecha/power tone reflecting the Megazord name. Angular borders, energetic symbols, powerful feeling. Not a TUI — rich markdown + ASCII art within text output. Framework-wide consistency.

**Per research recommendations:** Double-line box drawing characters (═, ║, ╔, ╗, ╚, ╝). ⚡ as the Megazord icon. Block letter banner for init only; simpler `⚡ MEGAZORD ►` prefix for stage banners.

Include the following sections:

**1. Init Banner** — Full "MEGAZORD" block letter ASCII art inside a double-line box. Include version placeholder `{VERSION}` and tagline "Project Management × Code Quality × Agent Teams".

**2. Stage Banners** — Compact `╔═══...═══╗ / ║  ⚡ MEGAZORD ► {STAGE} ║ / ╚═══...═══╝` format for regular skill output headers.

**3. Action Boxes** — Double-line boxes with title bar and content area for displaying structured information (settings summaries, file lists, status reports).

**4. Separators** — `═══...═══` for major section breaks.

**5. Status Symbols** — Define the icon vocabulary:
- ⚡ Active / Current / Power
- ✓ Complete / Passed
- ✗ Failed / Missing
- ◆ In Progress
- ○ Pending
- ⚠ Warning

**6. Progress Display** — `Power: ██████████░░░░░░░░░░ 50%` format.

**7. Section Headers** — `▸ {Section Name}` prefix.

**8. Next Up Block** — Template for suggesting the next command/action.

**9. Usage Notes** — Brief notes on when to use each element and the rule that ALL Megazord output must use these tokens for consistency.

Keep the file under 150 lines. This is a reference, not a tutorial.
  </action>
  <verify>
File exists at `skills/init/design-system.md`.
File contains "MEGAZORD" block letter art.
File contains all design token sections (banner, stage, action box, separator, symbols, progress, headers, next up).
Line count is under 150.
  </verify>
  <done>
`skills/init/design-system.md` exists with complete visual identity specification: init banner, stage banners, action boxes, separators, status symbols, progress display, section headers, and next-up block — all using double-line box drawing with tech/mecha aesthetic.
  </done>
</task>

</tasks>

<verification>
1. `bun run typecheck` passes (config.ts has no type errors)
2. `bun run lint` passes (config.ts follows biome conventions)
3. `src/lib/config.ts` exports: configSchema, MegazordConfig, presets, loadConfig, saveConfig, applyPreset, detectGsdConfig, migrateGsdConfig, CONFIG_FILENAME, qualitySchema, workflowSchema
4. `skills/init/design-system.md` is under 150 lines with all design tokens defined
5. No existing files were broken (paths.ts untouched, other skills untouched)
</verification>

<success_criteria>
- Config schema is the single source of truth for megazord.config.json structure
- Three preset profiles produce valid config when parsed through the schema
- GSD migration can detect old config.json and convert to Megazord format
- Design system defines a cohesive visual identity that all future skills will reference
- Both files are clean: type-checked, linted, and properly formatted
</success_criteria>

<output>
After completion, create `.planning/phases/02-project-initialization-and-configuration/02-01-SUMMARY.md`
</output>
