---
phase: 10-distribution-and-autocomplete-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - commands/debug.md
  - commands/discuss.md
  - package.json
autonomous: true
requirements:
  - DIST-03

must_haves:
  truths:
    - "commands/debug.md and commands/discuss.md exist and follow the exact proxy pattern"
    - "package.json files array includes 'commands' entry"
    - "bun pack --dry-run output shows all 14 commands/*.md files in tarball"
    - "npm-installed user gets commands/ directory with all proxy files"
  artifacts:
    - path: "commands/debug.md"
      provides: "Autocomplete proxy for /mz:debug"
      contains: "Invoke the mz:debug skill"
    - path: "commands/discuss.md"
      provides: "Autocomplete proxy for /mz:discuss"
      contains: "Invoke the mz:discuss skill"
    - path: "package.json"
      provides: "Distribution manifest with commands/ included"
      contains: "commands"
  key_links:
    - from: "package.json files array"
      to: "commands/"
      via: "npm packaging includes commands/ in tarball"
      pattern: "\"commands\""
    - from: "commands/debug.md"
      to: "skills/debug/SKILL.md"
      via: "Claude Code skill routing from /mz:debug autocomplete"
      pattern: "mz:debug"
---

<objective>
Fix npm distribution to include autocomplete proxy files for all 14 skills.

Purpose: npm-installed users currently get no autocomplete for `/mz:debug` and `/mz:discuss`, and the entire `commands/` directory is missing from the npm tarball because it's not listed in `package.json` `files`.

Output: Two new proxy files, updated `package.json`, verified E2E distribution via local tarball install.
</objective>

<execution_context>
@/Users/sh3rd3n/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sh3rd3n/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-distribution-and-autocomplete-fixes/10-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create missing autocomplete proxies and fix package.json distribution</name>
  <files>commands/debug.md, commands/discuss.md, package.json</files>
  <action>
Create two missing autocomplete proxy files following the exact pattern established by the 12 existing proxies in `commands/`. The pattern is:

```markdown
---
description: {concise description}
---

Invoke the mz:{skill-name} skill and follow it exactly as presented to you
```

**commands/debug.md:**
- description: `Systematic four-phase debugging (reproduce, isolate, root-cause, fix)`
- body: `Invoke the mz:debug skill and follow it exactly as presented to you`

**commands/discuss.md:**
- description: `Socratic brainstorming to explore approaches before implementation`
- body: `Invoke the mz:discuss skill and follow it exactly as presented to you`

**package.json:**
Add `"commands"` to the `files` array. Insert it after `"hooks"` to maintain alphabetical-ish ordering with the other content directories. The current array is: `["bin", "dist", "skills", "agents", "hooks", ".claude-plugin"]`. Add `"commands"` so it becomes: `["bin", "dist", "skills", "agents", "hooks", "commands", ".claude-plugin"]`.

**Validation before proceeding:** Confirm all 14 skills now have corresponding proxy files by listing `commands/` and `skills/` directories and cross-referencing.
  </action>
  <verify>
1. `ls commands/*.md | wc -l` returns 14 (12 existing + 2 new)
2. Verify content of `commands/debug.md` and `commands/discuss.md` matches the exact pattern (YAML frontmatter with `description`, body with `Invoke the mz:{name} skill...`)
3. `grep -c '"commands"' package.json` returns 1 (present in files array)
4. Cross-reference: for each directory in `skills/`, confirm a matching `.md` file exists in `commands/`
  </verify>
  <done>All 14 skills have autocomplete proxy files in commands/, and package.json files array includes "commands" for npm distribution.</done>
</task>

<task type="auto">
  <name>Task 2: E2E distribution verification via tarball install</name>
  <files></files>
  <action>
Perform end-to-end distribution verification per locked user decision:

**Step 1: Pre-fix tarball audit**
Run `bun pack --dry-run` and capture output. Verify `commands/` files are now present in the tarball listing. Perform full audit of all runtime-critical directories:
- `.claude-plugin/` -- must be present
- `skills/` -- must be present
- `commands/` -- must be present (this is the fix)
- `hooks/` -- must be present
- `bin/` -- must be present
- `agents/` -- check presence (expected: present)
- `scripts/` -- check presence (expected: missing -- report as finding)

**Step 2: Create test project**
```bash
mkdir -p ~/Programming/cortex-test
cd ~/Programming/cortex-test
bun init -y
```

**Step 3: Pack and install from local tarball**
```bash
cd ~/Programming/Megazord
bun pack  # Creates megazord-{version}.tgz
cd ~/Programming/cortex-test
bun add ~/Programming/Megazord/megazord-*.tgz
```

**Step 4: Verify autocomplete files in installed package**
```bash
ls node_modules/megazord/commands/
# Must show all 14 .md files including debug.md and discuss.md
ls node_modules/megazord/commands/ | wc -l  # Must be 14
```

**Step 5: Document findings**
Record any distribution gaps found during the audit (per CONTEXT.md: report only, do NOT fix):
- `scripts/` not in tarball (ownership enforcement hook broken for npm users)
- `agents/` in tarball but not in `install.ts` `dirsToCopy` (agent files not copied to plugin dir)
- `dist/` listed in files but directory doesn't exist (harmless)

**Step 6: Cleanup**
Remove the `.tgz` file from the Megazord directory. The cortex-test project can remain for future use.
  </action>
  <verify>
1. `bun pack --dry-run` output includes `commands/debug.md` and `commands/discuss.md`
2. `ls ~/Programming/cortex-test/node_modules/megazord/commands/ | wc -l` returns 14
3. `cat ~/Programming/cortex-test/node_modules/megazord/commands/debug.md` shows correct proxy content
4. `cat ~/Programming/cortex-test/node_modules/megazord/commands/discuss.md` shows correct proxy content
  </verify>
  <done>E2E distribution verified: all 14 autocomplete proxy files present in npm tarball and accessible after local tarball install. Distribution findings documented.</done>
</task>

</tasks>

<verification>
1. 14 proxy files in `commands/` matching 14 skills in `skills/`
2. `package.json` `files` array contains `"commands"`
3. `bun pack --dry-run` shows `commands/` directory contents in tarball
4. Local tarball install in cortex-test confirms commands/ present in `node_modules/megazord/commands/`
5. Distribution audit of all runtime-critical directories completed and findings documented
</verification>

<success_criteria>
- All 14 skills have corresponding autocomplete proxy files in commands/
- package.json files array includes "commands" for npm distribution
- E2E test confirms npm-installed users get full autocomplete proxy files
- Distribution audit findings documented (scripts/, agents/ copy, dist/ non-existent)
</success_criteria>

<output>
After completion, create `.planning/phases/10-distribution-and-autocomplete-fixes/10-01-SUMMARY.md`
</output>
