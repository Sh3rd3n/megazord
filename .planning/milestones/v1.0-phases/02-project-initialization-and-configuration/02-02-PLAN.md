---
phase: 02-project-initialization-and-configuration
plan: 02
type: execute
wave: 2
depends_on: [02-01]
files_modified:
  - skills/init/SKILL.md
  - skills/init/questioning.md
  - skills/init/presets.md
  - skills/init/migration.md
  - skills/settings/SKILL.md
  - skills/help/SKILL.md
autonomous: true
requirements: [PROJ-01, CONF-01, CONF-02, CONF-03, CONF-04, QUAL-05]

must_haves:
  truths:
    - "Running /mz:init creates .planning/ with PROJECT.md, STATE.md, and megazord.config.json"
    - "User is prompted for preset profile, model selection, workflow preferences, and quality overrides"
    - "Quick mode (--quick) creates minimal config with project name and default strict preset only"
    - "Existing .planning/ with GSD config is detected and migrated automatically"
    - "Running /mz:settings shows current config and allows modification"
    - "Config changes via /mz:settings take effect on next skill invocation"
    - "/mz:help shows init as Available and lists /mz:settings"
  artifacts:
    - path: "skills/init/SKILL.md"
      provides: "Full /mz:init flow: banner, detection, presets, context gathering, file creation"
      contains: "disable-model-invocation: false"
    - path: "skills/init/questioning.md"
      provides: "Deep context gathering question guide adapted from GSD methodology"
      contains: "vision"
    - path: "skills/init/presets.md"
      provides: "Preset profile definitions with all toggle values for Claude reference"
      contains: "strict"
    - path: "skills/init/migration.md"
      provides: "GSD detection and migration instructions for the init skill"
      contains: "config.json"
    - path: "skills/settings/SKILL.md"
      provides: "/mz:settings skill for post-init config viewing and modification"
      contains: "megazord.config.json"
    - path: "skills/help/SKILL.md"
      provides: "Updated help with init as Available and settings listed"
      contains: "Available"
  key_links:
    - from: "skills/init/SKILL.md"
      to: "skills/init/design-system.md"
      via: "@-reference for banner and visual tokens"
      pattern: "design-system"
    - from: "skills/init/SKILL.md"
      to: "skills/init/questioning.md"
      via: "@-reference for deep context gathering"
      pattern: "questioning"
    - from: "skills/init/SKILL.md"
      to: "skills/init/presets.md"
      via: "@-reference for preset profile definitions"
      pattern: "presets"
    - from: "skills/init/SKILL.md"
      to: "skills/init/migration.md"
      via: "@-reference for GSD migration logic"
      pattern: "migration"
    - from: "skills/settings/SKILL.md"
      to: "skills/init/design-system.md"
      via: "@-reference for consistent visual output"
      pattern: "design-system"
---

<objective>
Build the `/mz:init` and `/mz:settings` skills that drive the full project initialization and configuration workflow.

Purpose: Give developers a polished init experience (banner, presets, deep context gathering, GSD migration, auto-detect) and a post-init settings interface, making Megazord the first framework impression a great one.

Output: Complete `/mz:init` skill with 3 supporting files, `/mz:settings` skill, and updated `/mz:help` listing.
</objective>

<execution_context>
@/Users/sh3rd3n/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sh3rd3n/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-project-initialization-and-configuration/02-RESEARCH.md
@.planning/phases/02-project-initialization-and-configuration/02-01-SUMMARY.md
@src/lib/config.ts
@skills/init/design-system.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create /mz:init skill with supporting files</name>
  <files>
    skills/init/SKILL.md
    skills/init/questioning.md
    skills/init/presets.md
    skills/init/migration.md
  </files>
  <action>
Replace the stub `skills/init/SKILL.md` with the full init skill and create 3 supporting files. The skill.md IS the init program — Claude reads and executes it. Keep SKILL.md under 500 lines; use supporting files for detail.

**SKILL.md frontmatter:**
```yaml
name: init
description: Initialize a Megazord project with configuration and planning structure
disable-model-invocation: false
```
Note: Changed from `true` to `false` — this skill is now functional.

**SKILL.md flow structure (preset-first, per research recommendation):**

**Step 1: Display Banner**
- Reference `@skills/init/design-system.md` for the init banner ASCII art.
- Output the full MEGAZORD block letter banner with version and tagline.
- Set the tone: tech/mecha/power aesthetic.

**Step 2: Environment Detection**
- Check if `.planning/` directory exists.
- If `.planning/megazord.config.json` exists: already initialized. Show current config summary and ask if user wants to re-init (overwrite) or run `/mz:settings` instead. If user declines, exit gracefully.
- If `.planning/config.json` exists WITHOUT a `version` field: GSD project detected. Reference `@skills/init/migration.md` and follow GSD migration flow (read old config, migrate, preserve PROJECT.md, show what was migrated, let user confirm/adjust).
- If `.planning/` exists but neither config file: unknown planning directory. Ask user: overwrite, merge, or abort.
- If no `.planning/`: fresh init (proceed to Step 3).

**Step 3: Quick Mode Check**
- If the user invoked with `--quick` flag (check conversation context for the flag): skip deep gathering. Ask only for project name using AskUserQuestion (header: "Project", question: "What is this project called?"). Apply strict preset defaults. Jump to Step 8 (write files). Create minimal PROJECT.md with just the name and a "Fill in later or re-run /mz:init" note.

**Step 4: Preset Selection**
- Use AskUserQuestion with header "Profile" (7 chars, under 12 limit).
- Question: "Select your quality profile (you can customize individual settings next)"
- Options:
  - "Strict (Recommended)" — description: "Everything on: TDD, auto review, brainstorming, CORTEX, systematic debug"
  - "Balanced" — description: "Review + brainstorming on, TDD and CORTEX off"
  - "Minimal" — description: "Essential base features only"
- Reference `@skills/init/presets.md` for the full toggle values of each preset.

**Step 5: Model and Workflow Preferences**
- Use AskUserQuestion with header "Model" (5 chars).
- Question: "AI model profile for planning agents"
- Options:
  - "Quality (Recommended)" — description: "Opus everywhere — highest quality, higher cost"
  - "Balanced" — description: "Opus for planning, Sonnet for execution"
  - "Budget" — description: "Sonnet/Haiku — fastest, lowest cost"
- Then AskUserQuestion with header "Mode" (4 chars): "Execution mode" with options "YOLO (Recommended)" (description: "Autonomous execution, minimal prompts") and "Interactive" (description: "Confirm before each major action").
- Then AskUserQuestion with header "Depth" (5 chars): "Planning depth" with options "Comprehensive (Recommended)", "Standard", "Quick".
- Then AskUserQuestion with header "Git" (3 chars): "Git tracking for planning docs" with options "Yes (Recommended)" (commit .planning/ changes) and "No" (skip doc commits).

**Step 6: Quality Customization Gate**
- Ask: "Would you like to customize individual quality settings, or use the {selected preset} defaults?"
- If customize: Use AskUserQuestion for each toggle that differs from strict defaults. Only show toggles — don't re-ask what the preset already covers unless the user wants overrides.
  - Header "TDD" (3 chars): on/off
  - Header "Review" (6 chars): auto/manual/off
  - Header "Brainstorm" (10 chars): on/off
  - Header "CORTEX" (6 chars): on/off
  - Header "Debug" (5 chars): systematic/quick
- If using preset defaults: skip customization.

**Step 7: Deep Context Gathering**
- Reference `@skills/init/questioning.md` for the full questioning methodology.
- **Auto-detect first:** If codebase files exist (package.json, src/, etc.), analyze: package.json (name, deps, scripts), file patterns (glob for *.ts, *.tsx, *.config.*), git history (git log --oneline -10). Pre-compile answers: "I detected: {language} project using {runtime}, {test runner} for testing, {linter} for linting, {build tool} for building." Ask user to validate/correct.
- **Then deep questions:** Gather project vision, core value, requirements, tech stack, conventions, constraints. Use conversational questions, not a rigid form. No artificial limit on questions — be thorough. This is where the init becomes valuable.
- Build the PROJECT.md content from gathered context.

**Step 8: Write Files**
- Create `.planning/` directory (if not exists).
- Write `megazord.config.json` with all collected settings. Use the config schema from `src/lib/config.ts` as the canonical structure. Format with 2-space indent.
- Write `PROJECT.md` with gathered context. Use fixed section structure (per research recommendation): What This Is, Core Value, Requirements (Validated, Active, Out of Scope), Context, Constraints, Key Decisions.
- Write `STATE.md` with initial position: Phase 0, no plans, fresh project.

**Step 9: Summary and Next Steps**
- Display created files summary using action box from design system.
- Show config summary: preset, model, mode, depth, quality toggles.
- Suggest next step: "Run `/mz:plan` to create your roadmap" (or for greenfield: offer to auto-advance to roadmap creation).
- Suggest adding to CLAUDE.md: "This project uses Megazord. Run /mz:status for current state."

**questioning.md** (supporting file, ~100-150 lines):
Adapt GSD's deep questioning methodology for Megazord. Cover:
- Vision and purpose questions
- Requirements elicitation (what must it do? what's out of scope?)
- Tech stack questions (or auto-detected validation)
- Conventions and constraints
- Key decisions to pre-capture
- Tips for auto-detect: what to look for in package.json, tsconfig, file patterns

**presets.md** (supporting file, ~60-80 lines):
Document all three preset profiles with their exact toggle values in a clear table format. Include:
- Side-by-side comparison table
- What each toggle means in practice
- When to use each preset

**migration.md** (supporting file, ~60-80 lines):
GSD migration instructions:
- How to detect GSD format (config.json without version field)
- Field mapping: GSD config.json fields → Megazord megazord.config.json fields
- What to preserve (PROJECT.md content, STATE.md if exists, phase directories)
- What to add (quality section from strict preset, version: 1)
- How to handle unknown .planning/ (not GSD, not Megazord)
- Post-migration: show diff of what changed, let user confirm
  </action>
  <verify>
File exists at `skills/init/SKILL.md` with `disable-model-invocation: false`.
File exists at `skills/init/questioning.md`.
File exists at `skills/init/presets.md`.
File exists at `skills/init/migration.md`.
`skills/init/SKILL.md` is under 500 lines.
SKILL.md contains references to all 3 supporting files and the design system.
SKILL.md contains AskUserQuestion patterns with headers under 12 characters.
  </verify>
  <done>
`/mz:init` is a fully functional skill with: banner display, environment detection (fresh/GSD/existing Megazord/unknown), quick mode, preset-first configuration, deep context gathering, auto-detect, file creation (PROJECT.md, STATE.md, megazord.config.json), and next-step suggestions — supported by questioning.md, presets.md, and migration.md reference files.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create /mz:settings skill for post-init configuration</name>
  <files>skills/settings/SKILL.md</files>
  <action>
Create `skills/settings/` directory and `SKILL.md` for the `/mz:settings` command.

**Frontmatter:**
```yaml
name: settings
description: View and modify Megazord project configuration
disable-model-invocation: false
```

**Skill flow:**

**Step 1: Load and Display**
- Reference `@skills/init/design-system.md` for visual tokens.
- Display stage banner: `⚡ MEGAZORD ► SETTINGS`
- Read `.planning/megazord.config.json`. If not found, tell user to run `/mz:init` first and exit.
- Display current settings in a structured action box, organized by section:
  - **Project:** name, mode, depth, parallelization, commit_docs
  - **Model:** model_profile
  - **Quality:** tdd, review, brainstorming, cortex, debug
  - **Workflow:** research, plan_check, verifier
- Use status symbols (✓/✗) for boolean toggles.

**Step 2: Modification**
- Ask user what they'd like to change using AskUserQuestion (header: "Setting", question: "What would you like to change?").
- Options: "Quality settings", "Workflow settings", "Model profile", "Mode / Depth", "Nothing — looks good".
- If "Nothing": exit with "Settings unchanged" message.
- If a section selected: show AskUserQuestion for each toggle in that section with current value highlighted.
- After changes: write updated config back to `.planning/megazord.config.json`.
- Show summary of what changed.

**Step 3: Confirmation**
- Show updated settings summary.
- Note: "Changes take effect on next skill invocation" (per research: skills read config at invocation time, so this is automatic).

Keep under 200 lines. This is a simpler skill than init.
  </action>
  <verify>
File exists at `skills/settings/SKILL.md`.
Frontmatter has `disable-model-invocation: false`.
Skill references design-system.md.
Skill handles missing config gracefully (suggests /mz:init).
File is under 200 lines.
  </verify>
  <done>
`/mz:settings` skill exists with: stage banner, current settings display with section grouping, modification flow via AskUserQuestion, config write-back, and change summary — providing the primary post-init configuration interface.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update /mz:help to reflect new skills</name>
  <files>skills/help/SKILL.md</files>
  <action>
Update `skills/help/SKILL.md` to:

1. Change `/mz:init` status from "Coming soon" to "Available"
2. Add `/mz:settings` row to the table: description "View and modify project configuration", status "Available"
3. Update the phase reference at the bottom: "Phase: 2 of 8 (Project Initialization and Configuration)"
4. Reference `@skills/init/design-system.md` for consistent visual output. Add the stage banner (`⚡ MEGAZORD ► HELP`) at the top of the displayed output (after the frontmatter/instructions).

Keep the existing table structure. Only add/modify the rows and phase line mentioned above. Do not change other skill statuses.
  </action>
  <verify>
`skills/help/SKILL.md` contains `/mz:init` with status "Available".
`skills/help/SKILL.md` contains `/mz:settings` row.
`skills/help/SKILL.md` references Phase 2.
Other skill statuses remain "Coming soon".
  </verify>
  <done>
`/mz:help` lists `/mz:init` as Available, includes `/mz:settings` as a new Available skill, and references Phase 2 as the current phase.
  </done>
</task>

</tasks>

<verification>
1. `/mz:init` skill is functional (disable-model-invocation: false) with complete flow
2. All 3 supporting files exist and are referenced from SKILL.md
3. `/mz:settings` skill loads config, displays settings, and supports modification
4. `/mz:help` reflects the two new available skills
5. All AskUserQuestion headers are under 12 characters
6. Init SKILL.md is under 500 lines
7. No existing skills (other than help and init) were modified
8. Design system is referenced by both init and settings skills
</verification>

<success_criteria>
- A user can invoke /mz:init and be guided through project setup with presets, model selection, workflow preferences, and deep context gathering
- Quick mode (--quick) provides a fast path with minimal questions
- GSD migration is handled automatically when detected
- /mz:settings provides a post-init way to view and change any setting
- /mz:help accurately reflects which skills are available
- All skills maintain consistent visual identity via design system reference
</success_criteria>

<output>
After completion, create `.planning/phases/02-project-initialization-and-configuration/02-02-SUMMARY.md`
</output>
